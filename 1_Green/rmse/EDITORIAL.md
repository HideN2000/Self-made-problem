問題は非負のソート済配列Xの要素に対してK回以下要素をデクリメントできる時の操作後の要素の二乗和の最小化と同じです.

上記の問題を考えるにあたって任意の操作の後数列Xのソート大小関係は不変と仮定して一般性を失いません.

なぜならそうでない場合同等の操作でより良い解を得られることが明らかだからです.

したがって上から何番目の項まで均一化されるかを考えることで線形時間で解が求まります.

二分探索で解く方法もあります.

なお求値の整数部分を取る際は誤差に注意する必要があるかもしれません