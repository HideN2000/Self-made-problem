$gcd(i,j)$が$N$の約数であることが必要十分です.

上記より包除原理と調和級数の性質より高速に求められます.
