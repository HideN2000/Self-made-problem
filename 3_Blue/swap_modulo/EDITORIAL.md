 $dp[S][r] = 元々のpopcount(S)番目までの桁の数字をSの位置に並べたときに、modulo M で r となるときの最小の転倒数$
 
 と定義します。
 
 答えは$dp[(1 << |N|) - 1][M]$です。
 
 時間計算量は$O(1 << |N| * N * M)  = ~ 10  ^ 8$ほどであり、十分高速です。