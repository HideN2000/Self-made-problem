ファレイ数列のもつ性質に関する問題です。なお、ファレイ数列というのは、題意に示す通り

自然数$M$に対して定義され、$0$および分母が$M$以下の既約分数を昇順に並べたものです。

ファレイ数列にはいくつか面白い性質があり、ここではそのうちの一つが解答する上でのキーとなります。

勘のいい方だとサンプル$1$でお気づきかもしれませんが、それは

・$\frac{x_i}{y_i},\frac{x_{i + 1}}{y_{i + 1}}$をファレイ数列の隣接する二項とするとき、$(※)x_{i + 1} * y_i - x_i * y_{i + 1} = 1$が成立する。

というものです。

（定理の証明は省略します。気になる方は、ハーディの数論入門Iの第$3$章などを読んでみてください。)

上記の性質がわかれば、あとは簡単です。

ここで、我々にとって既知の数字は$x_{i},y_{i}$であり、未知の数字は$x_{i + 1},y_{i + 1}$です。

$gcd(x_i,y_i) | 1$より、方程式$(※)$には、解が存在し、特殊解$(x_{i + 1},y_{i + 1}) = (h,k)$を$O(logMax(x_i,y_i))$で求めた後、

その一般解は

$(x_{i + 1},y_{i + 1}) = (h + x_i * t,k + y_i * t)$と書き表せます。

あとは、初めて

$\frac{x_i}{y_i} < \frac{x_{i + 1}}{y_{i + 1}}$

すなわち

$\frac{x_i}{y_i} < \frac{h + x_i * t}{k + y_i * t}$

を満たすもので、$\frac{x_i}{y_i}$を超えずできるだけそれに近い値を与える$t$を決定すれば良いです。

時間計算量は$O(log(Max(x_i,y_i))$です。

なお、この性質を知らなくても、同じ対数時間で解くことは可能です。（ここでは省略します。)

【COLUMN】

余談ですが、この事実を使用すれば、JOIにて出題された[fraction](https://atcoder.jp/contests/joisc2008/tasks/joisc2008_fraction)という問題についても、

$O(KlogM)$で解答を直接的かつ簡潔に求めることができます。

以下にそのコードを記載します。
```Pythonによる解答コード
def f(h, k, N):
    x = pow(k, - 1, h)
    y = (k*x-1)//h
    p = (N-y)//k
    return x+p*h, y+p*k
M, K = map(int, input().split())
p, q = 1, M
for i in range(K - 1):
    p, q = f(p, q, M)
if p < q:
    print(p, q)
else:
    print(-1)
```
